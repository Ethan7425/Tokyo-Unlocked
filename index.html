<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <title>Escape Game</title>
    <link rel="stylesheet" href="/css/style.css" />
  </head>

  <body>
    <div id="app">

      <!-- ============================
           LOGIN SCREEN
      ============================ -->
      <div id="login-screen" class="screen active">
        <div class="card fade-in">
          <h1>Welcome</h1>
          <p class="subtitle">Enter your details to begin your adventure</p>

          <form id="login-form">
            <div class="input-group">
              <label for="nickname">Nickname *</label>
              <input
                type="text"
                id="nickname"
                placeholder="Choose a nickname"
                required
                maxlength="20"
                autocomplete="off"
              />
            </div>

            <div class="input-group">
              <label for="pin">PIN (optional)</label>
              <input
                type="password"
                id="pin"
                placeholder="4-digit PIN"
                maxlength="4"
                pattern="[0-9]{4}"
                autocomplete="off"
              />
              <small>Used to protect your progress on this device</small>
            </div>

            <button type="submit" class="btn-primary">Enter Game</button>
          </form>
        </div>
      </div>


      <!-- ============================
           HOME SCREEN
      ============================ -->
      <div id="home-screen" class="screen">
        <div class="container fade-in">
          <header class="header">
            <h1>Welcome, <span id="welcome-nickname"></span></h1>
            <button id="logout-btn" class="btn-ghost">Logout</button>
          </header>

          <div class="main-menu">
            <button class="menu-card" data-screen="play">
              <div class="card-icon">üéÆ</div>
              <h2>Play</h2>
              <p>Continue your adventure</p>
            </button>

            <button class="menu-card" data-screen="profile">
              <div class="card-icon">üë§</div>
              <h2>Profile</h2>
              <p>View stats and settings</p>
            </button>
          </div>
        </div>
      </div>


      <!-- ============================
           PLAY SCREEN (CHAPTER SELECTION)
      ============================ -->
      <div id="play-screen" class="screen">
        <div class="container fade-in">
          <header class="header">
            <button class="btn-back" data-screen="home">‚Üê Back</button>
            <h1>Select Chapter</h1>
          </header>

          <div class="chapters-grid" id="chapters-grid"></div>
        </div>
      </div>


      <!-- ============================
           CHAPTER SCREEN (CHATBOT)
      ============================ -->
      <div id="chapter-screen" class="screen">
        <div class="container fade-in">
          <header class="header">
            <button class="btn-back" data-screen="play">‚Üê Back to Chapters</button>
            <h1 id="chapter-title"></h1>
          </header>

          <div class="chapter-content">
            <div class="content-card">
              <h2 id="chapter-heading"></h2>
              <p id="chapter-description"></p>
              <div id="chapter-intro" class="chapter-intro"></div>
            </div>

            <div class="content-card chatbot-section">
              <div id="chatbot-container">
                <div class="message-thread" id="message-thread"></div>
                <div class="input-area">
                  <input
                    type="text"
                    id="user-message-input"
                    placeholder="Type your message..."
                    autocomplete="off"
                  />
                  <button id="send-message-btn" class="btn-primary" style="width: auto; padding: 0.6rem 1.5rem;">Send</button>
                </div>
              </div>
            </div>

            <button id="chapter-reset-btn" class="btn-secondary">Reset Chapter</button>
          </div>
        </div>
      </div>


      <!-- ============================
           PROFILE SCREEN
      ============================ -->
      <div id="profile-screen" class="screen">
        <div class="container fade-in">
          <header class="header">
            <button class="btn-back" data-screen="home">‚Üê Back</button>
            <h1>Profile</h1>
          </header>

          <div class="profile-content">
            <!-- User Info Card -->
            <div class="content-card profile-card">
              <div class="avatar-section">
                <div id="avatar-display" class="avatar">
                  <span id="avatar-initial"></span>
                </div>

                <input type="file" id="avatar-upload" accept="image/*" style="display: none;" />
                <button id="change-avatar-btn" class="btn-secondary">Change Avatar</button>
              </div>

              <div class="profile-info">
                <h2 id="profile-nickname"></h2>
                <p class="joined-date">Joined: <span id="joined-date"></span></p>
              </div>
            </div>

            <!-- Stats -->
            <div class="content-card stats-card">
              <h3>üìä Progress Stats</h3>
              <div class="stats-grid">
                <div class="stat-item">
                  <span class="stat-label">Chapters Completed</span>
                  <span class="stat-value" id="stat-chapters">0</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">Puzzles Solved</span>
                  <span class="stat-value" id="stat-puzzles">0</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">Total Time Played</span>
                  <span class="stat-value" id="stat-time">0h 0m</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">Best Score</span>
                  <span class="stat-value" id="stat-score">0</span>
                </div>
              </div>
              <small class="stats-note">üèÜ Leaderboard integration coming soon</small>
            </div>

            <!-- Account Actions -->
            <div class="content-card" style="text-align: center;">
              <button id="profile-logout-btn" class="btn-danger">Logout</button>
              <button id="delete-account-btn" class="btn-danger" style="margin-top: 0.8rem; background:#b91c1c;">
                üóë Delete Account
              </button>
            </div>
          </div>
        </div>
      </div>

    </div>

    <!-- ============================
         SCRIPT IMPORTS
    ============================ -->
    <script type="module" src="/js/config.js"></script>
    <script type="module" src="/js/logger.js"></script>
    <script type="module" src="/js/storage.js"></script>
    <script type="module" src="/js/firebase-init.js"></script>
    <script type="module" src="/js/auth.js"></script>
    <script type="module" src="/js/ui.js"></script>
    <script type="module" src="/js/app.js"></script>

  </body>
</html>
